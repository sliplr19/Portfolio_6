---
title: "Portfolio_6"
author: "Lindley Slipetz"
date: "3/15/2021"
output: html_document
---

This project I have to get done quickly because it's time sensitive: it's a March Madness predictor code! The first game is Thursday, so I'll need to get my predictions together before then. We have a lot of datafiles to go through and then I'll try to cobble them together in a way that makes sense to me (and maybe no one else). 

```{r packages_data, warning = FALSE, message = FALSE}
library(tidyverse)
#install.packages("gdata")
library(gdata)
power_rankings <- read.csv("C:\\Users\\Owner\\Documents\\Portfolio_6\\Portfolio_6\\data\\power_rankings.txt", header = TRUE, stringsAsFactors = FALSE)
rpi <- read.csv("C:\\Users\\Owner\\Documents\\Portfolio_6\\Portfolio_6\\data\\rpi.txt", header = TRUE, stringsAsFactors = FALSE)
basic <- read.csv("C:\\Users\\Owner\\Documents\\Portfolio_6\\Portfolio_6\\data\\basic_stats.txt", header = TRUE, stringsAsFactors = FALSE)
adv <- read.csv("C:\\Users\\Owner\\Documents\\Portfolio_6\\Portfolio_6\\data\\adv_stats.txt", header = TRUE, stringsAsFactors = FALSE)
```

Okay, now I'm going to make a dataframe that will serve as my bracket. I tried finding something nice online that would 
```{r bracket_creation}
bracket <- data.frame(stringsAsFactors = FALSE)
team <- c("Gonzaga", "Appalachian St.", "Oklahoma",
           "Missouri", "Creighton", "UC Santa Barbara",  
           "Virginia",
           "Ohio", "Southern California", "Wichita St.", "Kansas", 
           "Eastern Wash.", "Oregon", "VCU", "Iowa",
           "Grand Canyon", "Michigan", "Texas Southern", "LSU", "St. Bonaventure", "Colorado",
           "Georgetown", "Florida St.", 
           "UNC Greensboro", "BYU", "UCLA", "Texas",
           "Abilene Christian", "UConn", "Maryland",
           "Alabama", "Iona", "Baylor", "Hartford",
           "North Carolina", "Wisconsin", "Villanova",
           "Winthrop", "Purdue", "North Texas", 
           "Texas Tech", "Utah St.", "Arkansas",
           "Colgate", "Florida", "Virginia Tech",
           "Ohio St.", "Oral Roberts", "Illinois",
           "Drexel", "Loyola Chicago", "Georgia Tech", "Tennessee", "Oregon St.", "Oklahoma St.",
           "Liberty", "San Diego St.", "Syracuse",
           "West Virginia", "Morehead St.",
           "Clemson", "Rutgers", "Houston",
           "Cleveland St.")
bracket <- as.data.frame(cbind(team), stringsAsFactors = FALSE)
```

I want to have a dataframe of all the data and a dataframe to use as the bracket. Let's create a new dataframe for all of the data. To do that, I'll need to do some editing of the adv and basic dataframes. The problem is there will be columns with the same name, so we need to rename some columns

```{r ad/ba_redo}
adv$Overall.1[adv$Overall.1 == "W"] <- "W-ovrl"
adv$Overall.2[adv$Overall.2 == "L"] <- "L-ovrl"
adv$Conf.[adv$Conf. == "W"] <- "W-conf"
adv$Conf..1[adv$Conf..1 == "L"] <- "L-conf"
adv$Home[adv$Home == "W"] <- "W-home"
adv$Home.1[adv$Home.1 == "L"] <- "L-home"
adv$Away[adv$Away == "W"] <- "W-away"
adv$Away.1[adv$Away.1 == "L"] <- "L-away"
basic$Overall.1[basic$Overall.1 == "W"] <- "W-ovrl"
basic$Overall.2[basic$Overall.2 == "L"] <- "L-ovrl"
basic$Conf.[basic$Conf. == "W"] <- "W-conf"
basic$Conf..1[basic$Conf..1 == "L"] <- "L-conf"
basic$Home[basic$Home == "W"] <- "W-home"
basic$Home.1[basic$Home.1 == "L"] <- "L-home"
basic$Away[basic$Away == "W"] <- "W-away"
basic$Away.1[basic$Away.1 == "L"] <- "L-away"
colnames(adv) <- as.character(adv[1,])
colnames(basic) <- as.character(basic[1,])
names(adv)[names(adv) == "School"] <- "team"
names(basic)[names(basic) == "School"] <- "team"
adv <- adv[-1, ] 
basic <- basic[-1, ] 
```

Okay, now I'm going to check for repeat columns across the dataframes before combining them. There's also some empty columns in the adv and basic data frames that I'll delete. I'm having trouble deleting them by name, so I'm just going to go with number.


```{r delete_2}
basic <- basic[, -c(1, 3:21)]
adv <- adv[, -c(9, 12, 15, 18, 21)] 
```

Okay, one last thing before we smoosh the dataframes together. We need to make sure the teams match. I've been trying to do this the fancy with agrep, but I've been struggling. Since I'm in a time crunch, I'm just going to do this by brute force. 
```{r name_match}
for(i in 1:nrow(basic)){
    basic[i,1] <- str_replace(basic[i,1], "NCAA", "")
    basic[i,1] <- str_replace(basic[i,1], "State", "St.")
    basic[i,1] <- str_replace(basic[i,1], "UC-Santa Barbara", "UC Santa Barbara")
    basic[i,1] <- str_replace(basic[i,1], "Eastern Washington", "Eastern Wash.")
    basic[i,1] <- str_replace(basic[i,1], "North Carolina-Greensboro", "UNC Greensboro")
}
for(i in 1:nrow(adv)){
    adv[i,1] <- str_replace(adv[i,1], "NCAA", "")
    adv[i,1] <- str_replace(adv[i,1], "State", "St.")
    adv[i,1] <- str_replace(adv[i,1], "UC-Santa Barbara", "UC Santa Barbara")
    adv[i,1] <- str_replace(adv[i,1], "Eastern Washington", "Eastern Wash.")
    adv[i,1] <- str_replace(adv[i,1], "North Carolina-Greensboro", "UNC Greensboro")
}

```
Okay, now let's make a monster dataframe. 

```{r all_data}
NCAA_data <- left_join(bracket, power_rankings, by = "team",  suffix = c(".x", ".y"))
NCAA_data <- left_join(NCAA_data, rpi, by = "team",  suffix = c(".x", ".y"))
NCAA_data <- left_join(NCAA_data, basic, by = "team",  suffix = c(".x", ".y"))
NCAA_data <- left_join(NCAA_data, adv, by = "team",  suffix = c(".x", ".y"))
```

Okay, now we have our monster dataframe. Before we start doing stuff with it, let's make a quick edit to our bracket dataframe. I want it to represent the different rounds of the tournament, so...

```{r bracket_rev}
brack_names <- c("Round_2", "Round_3",
                       "Round_4", "Round_5", "Round_6")
bracket[ ,brack_names] <- NA

```
Now is the time I step away from Rstudio and start deciding which stats I would like to use to choose my times. From the little I already know about NCAA basketball is that the best offense or (exclusive) the best defense is usually eliminated early. You need a good balance of offense and defense to make it far in the tournament. So two of the measures that I'll be using are a measure of offense and a measure of defense.